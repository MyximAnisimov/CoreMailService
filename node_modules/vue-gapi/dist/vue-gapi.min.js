/*!
 * vue-gapi v2.1.3
 * (c) 2024 CedricPoilly
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueGapi={},e.Vue)}(this,function(e,t){"use strict";var i=Symbol("gapi");function r(e){this.clientConfig=JSON.parse(JSON.stringify(e)),this.promise=null,this.client=null}function o(e){return{accessToken:e.access_token,idToken:e.id_token,expiresAt:e.expires_at}}r.prototype.getClientConfig=function(){return this.clientConfig},r.prototype.getClient=function(){var i=this;return null!==this.client?Promise.resolve(this.client):(null===this.promise&&(this.promise=new Promise(function(t,o){var n=document.createElement("script");n.src="https://apis.google.com/js/api.js",n.onreadystatechange=n.onload=function(){var e=setInterval(function(){n.readyState&&!/loaded|complete/.test(n.readyState)||(clearInterval(e),window.gapi?t(window.gapi):o())},100)},n.onerror=function(e,t,n,i,r){o({message:e,url:t,line:n,column:i,error:r})},document.getElementsByTagName("head")[0].appendChild(n)}).then(function(n){return new Promise(function(e,t){n.load("client:auth2",function(){n.client.init(i.clientConfig).then(function(){i.client={gapi:n,authInstance:n.auth2.getAuthInstance()},e(i.client)},t)})})})),this.promise)};function s(e,t){this.clientProvider=e,this.sessionStorage=t}function u(e){void 0===e&&(e=window.localStorage),this.localStorage=e}s.prototype.getGapiClient=function(){return this.clientProvider.getClient().then(function(e){return e.gapi})},s.prototype.getAuthInstance=function(){return this.clientProvider.getClient().then(function(e){return e.authInstance})},s.prototype.getCurrentUser=function(){return this.getAuthInstance().then(function(e){return e.currentUser.get()})},s.prototype.getOfflineAccessCode=function(){return this.sessionStorage.getItem("offlineAccessCode")},s.prototype.grantOfflineAccess=function(){var t=this;return this.getAuthInstance().then(function(e){return e.grantOfflineAccess().then(function(e){e=e.code;return t.sessionStorage.setItem("offlineAccessCode",e),e})})},s.prototype.hasGrantedRequestedScopes=function(e){var t=this.clientProvider.getClientConfig().scope;return!t||e.hasGrantedScopes(t)},s.prototype.login=function(){var r=this;return this.clientProvider.getClient().then(function(e){var i=e.gapi;return e.authInstance.signIn().then(function(e){var t,n;return r.sessionStorage.set((n=o((t=e).getAuthResponse(!0)),(t=t.getBasicProfile())&&(n.id=t.getId(),n.fullName=t.getName(),n.firstName=t.getGivenName(),n.lastName=t.getFamilyName(),n.email=t.getEmail(),n.imageUrl=t.getImageUrl()),n)),{currentUser:e,gapi:i,hasGrantedScopes:r.hasGrantedRequestedScopes(e)}})})},s.prototype.refreshToken=function(){var t=this;return this.getCurrentUser().then(function(e){return e.reloadAuthResponse()}).then(function(e){return t.sessionStorage.set(Object.assign({},t.sessionStorage.get(),o(e))),e})},s.prototype.grant=function(){var n=this;return this.getCurrentUser().then(function(e){if(n.hasGrantedRequestedScopes(e))return e;var t=n.clientProvider.getClientConfig().scope;return e.grant({scope:t}).then(function(){return e})})},s.prototype.logout=function(){var e=this;return this.getAuthInstance().then(function(e){return e.signOut()}).then(function(){return e.sessionStorage.clear()})},s.prototype.isAuthenticated=function(){return(new Date).getTime()<this.sessionStorage.getItem("expiresAt")},s.prototype.isSignedIn=function(){return this.getCurrentUser().then(function(e){return e.isSignedIn()})},s.prototype.listenUserSignIn=function(t){return this.getAuthInstance().then(function(e){t(e.currentUser.get().isSignedIn()),e.isSignedIn.listen(t)})},s.prototype.getUserData=function(){return this.sessionStorage.get()};var n="gapi.session";u.prototype.set=function(e){this.localStorage.setItem(n,JSON.stringify(e))},u.prototype.setItem=function(e,t){var n=this.get()||{};n[e]=t,this.set(n)},u.prototype.get=function(){return JSON.parse(this.localStorage.getItem(n))},u.prototype.getItem=function(e){return(this.get()||{})[e]},u.prototype.clear=function(){this.localStorage.removeItem(n)};e.default={install:function(e,t){var t=new r(t),n=new u,t=new s(t,n);e.config.globalProperties.$gapi=t,e.provide(i,t)}},e.useGapi=function(){return t.inject(i)},e.version="2.1.3",Object.defineProperty(e,"__esModule",{value:!0})});